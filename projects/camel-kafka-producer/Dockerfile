FROM openjdk:11.0-jre-slim-buster

ARG DEPENDENCY=build/libs/dependency
ARG JAR_FILE=build/libs/camel-kafka-producer-*.jar
ARG KAFKA_BROKERS_ARG
ARG KAFKA_CONSUMER_GROUP_ARG
ARG KAFKA_TOPIC_ARG

ARG MAX_IDLE_SECONDS_ARGS

ENV KAFKA_BROKERS ${KAFKA_BROKERS_ARG}
ENV KAFKA_CONSUMER_GROUP ${KAFKA_CONSUMER_GROUP_ARG}
ENV KAFKA_TOPIC ${KAFKA_TOPIC_ARG}

ENV MAX_IDLE_SECONDS ${MAX_IDLE_SECONDS_ARGS}

WORKDIR /app

COPY ${DEPENDENCY}/BOOT-INF/lib/*.jar /app/
COPY ${JAR_FILE} /app/camel-kafka-producer.jar
ENTRYPOINT ["java", "-jar", "/app/camel-kafka-producer.jar"]
